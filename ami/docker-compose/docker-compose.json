{
    "min_packer_version": "0.12.0",
    "variables": {
        "aws_profile": "{{env `AWS_PROFILE`}}",
        "aws_region": "us-west-2"
    },
    "builders": [{
        "ami_name": "docker-compose",
        "instance_type": "t2.micro",
        "region": "{{user `aws_region`}}",
        "profile": "{{user `aws_profile`}}",
        "source_ami": "ami-ba602bc2",
        "type": "amazon-ebs",
        "ssh_username": "ubuntu"
    }],
    "provisioners": [{
        "type": "shell",
        "inline": [
            "sleep 30",
            "wget -qO- https://get.docker.com/ | sh",
            "sudo usermod -aG docker $(whoami)",
            "sudo apt-get -y install python-pip",
            "sudo pip install docker-compose"
            ]
    }]
}
